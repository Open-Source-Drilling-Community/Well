# WebApp (NORCE.Drilling.Well.WebApp)

Blazor Server web application providing a user interface for the Well microservice. It lists, creates, edits, and deletes Well records, and displays usage statistics. The app consumes the Service API through a generated client model and uses MudBlazor for UI components.

## Purpose
- Provide a UI to manage Well data exposed by the backend Service.
- Visualize and interact with Well lists and details; show usage statistics.
- Integrate unit/quantity inputs via reusable components and call related microservices when configured.

## Installation

Prerequisites
- .NET 8 SDK
- Optional: Docker 24+ if containerizing

Local Run
1) Restore/build from the solution root:
   - `dotnet restore`
   - `dotnet build`
2) Run the WebApp (uses the launch profile URLs 5011/5012):
   - `dotnet run --project WebApp`
3) Open the UI:
   - `https://localhost:5011/Well/webapp/Well` or `http://localhost:5012/Well/webapp/Well`

Configure Backend Endpoints
- Configure the Service and related endpoints via appsettings or environment variables:
  - `WellHostURL` (default dev: `https://localhost:5001/`)
  - `ClusterHostURL`
  - `FieldHostURL`
  - `UnitConversionHostURL`
- Example (PowerShell):
  - `$env:WellHostURL = "https://localhost:5001/"; dotnet run --project WebApp`

Notes
- The app is mounted under the path base `/Well/webapp` (Kestrel and reverse proxy must route accordingly).
- Forwarded headers are enabled for proxy scenarios.

Docker
1) Build:
   - `docker build -t digiwells/norcedrillingwellwebappclient:local -f WebApp/Dockerfile .`
2) Run:
   - `docker run --rm -p 5002:8080 -e WellHostURL=https://host.docker.internal:5001/ digiwells/norcedrillingwellwebappclient:local`
3) Open:
   - `http://localhost:5002/Well/webapp/Well`

Helm (Kubernetes)
- A chart is provided under `WebApp/charts/norcedrillingwellwebappclient`.
- Example install with defaults:
  - `helm upgrade --install well-webapp WebApp/charts/norcedrillingwellwebappclient`

## Usage

Navigation
- Main Well page: `/Well/webapp/Well`
- Usage statistics: `/Well/webapp/Statistics`

Typical Actions
- Add Well: click Add, fill details, then Update in the edit view.
- Edit Well: select a row, modify fields, click Update.
- Delete Well: use the delete icon or multi-select + Delete.

## Dependencies
- Packages
  - `MudBlazor` (via MudBlazor.Services) — UI components and theming.
  - `Plotly.Blazor` — charting support.
  - `OSDC.UnitConversion.DrillingRazorMudComponents` — unit/quantity input components.
  - `OSDC.DotnetLibraries.General.DataManagement` — shared MetaInfo and helpers.
- Project reference
  - `ModelSharedOut` — generated OpenAPI client and DTOs (`NORCE.Drilling.Well.ModelShared`), used by `Shared/APIUtils.cs`.

See `WebApp.csproj` for exact versions and build targets.

## Integration in the Solution
- Calls the backend `Service` API using the generated `ModelSharedOut` client (`APIUtils.ClientWell`, etc.).
- Reads base URLs from configuration to reach other microservices (Well, Cluster, Field, UnitConversion).
- Uses the DTOs and OpenAPI bundle generated by `ModelSharedOut` (sourced from the Service’s merged schema).
- UI built with MudBlazor; mounted under `/Well/webapp` to align with the Helm ingress and reverse proxy configuration.

## Notable Files
- `Program.cs` — Blazor Server setup, path base `/Well/webapp`, forwarded headers, config ingestion.
- `Shared/APIUtils.cs` — HttpClient setup and generated client instances for Well/Field/Cluster.
- `Pages/WellMain.razor` — grid of wells, add/delete/select.
- `Pages/WellEdit.razor` — edit view with unit-aware inputs.
- `Pages/StatisticsMain.razor` — displays aggregated usage statistics.
- `Properties/launchSettings.json` — local URLs and profiles.

## Quick Links
- Swagger (dev): https://dev.digiwells.no/Well/api/swagger
- Service API (dev): https://dev.digiwells.no/Well/api/Well
- WebApp (dev): https://dev.digiwells.no/Well/webapp/Well
